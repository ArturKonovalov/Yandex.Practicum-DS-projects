# Восстановление золота из руды

## Описание задачи:

Необходимо подготовить прототип модели машинного обучения для компании «Цифра». 
Фирма разрабатывает решения для эффективной работы промышленных предприятий.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Цель исследования:
Предсказать коэффициент восстановления золота из золотосодержащей руды.  

### Исследование пройдёт в 3 этапа:
1. Подготовка данных.
2. Анализ данных.
3. Обучение и тестирование моделей.
____ 
### Ход исследования: 

### Этап 1. Подготовка данных:
- Первым делом откроем датасет и изучим основные аспекты.
- Проверим правильность заполнения, наименования столбцов\
- Проверим правильность расчета эффективности обогащения.
- Проанализируем признаки в выборках.
- Продиагностируем данные на наличие пропусков и дубликатов.
- Удалим ненужные столбцы.

### Этап 2. Исследовательский анализ данных:
- Построим графики изменения концентрации металлов на различных этапах очистки.
- Сравним распределения размеров гранул сырья на обучающей и тестовой выборках.
- Исследуем суммарную концентрацию всех веществ на разных стадиях в сырье.

### Этап 3. Обучение и проверка модели:
- Создадим выборки с нужными признаками.
- Стандартизируем данные.
- Подберем гиперпараметры дерева решений для целевого признака этапа *rougher* и *final*.
- Подберем гиперпараметры случайного леса для целевого признака этапа *rougher* и *final*.
- Подберем гиперпараметры линейной регрессии для целевого признака этапа *rougher* и *final*.
- Выберем лучшую модель.
- Построим константную модель для проверки на вменяемость.
- Обучим лучшую модель и протестируем ее.
___________
Стек технологий и инструментов:
`pandas` `numpy` `seaborn`  `pyplot` `random`

`mean_absolute_error` `make_scorer` `StandardScaler` `DummyRegressor`

  `DecisionTreeRegressor`  `RandomForestRegressor`  `cross_val_score`

 `LinearRegression` `RandomizedSearchCV`

___________
# Итоги исследования:
* Все три датасета взаимодополнены и приведены в соответствии друг с другом
* Удалены аномальные значения на различных стадиях.
* Создан кастомный скорер sMAPE.
* Подобраны гиперпараметры и обучены модели:
   * Линейной регрессии
   * Дерева решений
   * Случайного леса
* Лучшая наблюдаемая модель — это `RandomForest` с параметрами:
  * max_depth: `14`
  * n_estimators: `30`
  * Итоговое sMAPE : `9.2932`

EDA:
* Концентрация золота равномерно увеличивается на протяжении всей стадии обработки.
* Концентрация серебра, повышается после флотации, после чего начинает снижаться, в финальном концентрате его становится меньше чем было в изначальном сырье.
* Концентрация свинца незначительно увеличивается, а потом остается на уровне первичной очистки.
* Распределение размеров гранул исходного сырья на обучающей и тестовой выборках показывает, что размеры частиц существенно не различаются.

